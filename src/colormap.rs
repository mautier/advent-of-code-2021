/// A single RGB tuple, with 8-bit depth.
#[derive(Copy, Clone, Debug)]
pub struct Rgb([u8; 3]);

impl Rgb {
    pub fn new(r: u8, g: u8, b: u8) -> Self {
        Self([r, g, b])
    }
    pub fn r(self) -> u8 {
        self.0[0]
    }
    pub fn g(self) -> u8 {
        self.0[1]
    }
    pub fn b(self) -> u8 {
        self.0[2]
    }
}

/// A helper for converting values to colors using a linear mapping.
///
/// For simplicity, the input values are f32.
#[derive(Copy, Clone, Debug)]
pub struct LinearColorScale {
    pub min: f32,
    pub max: f32,
}

impl LinearColorScale {
    /// Maps an input value to a color.
    /// The mapping is saturating, ie out-of-bounds inputs will be clipped to the valid range.
    pub fn map(self, value: f32) -> Rgb {
        // Clip to the valid range.
        let value = value.clamp(self.min, self.max);
        let index = (255.0 * (value - self.min) / (self.max - self.min)).round() as usize;
        PLASMA[index]
    }
}

/// The plasma colormap.
///
/// This is copied (and scaled to [0, 255]) from the matplotlib project, see the following links:
/// - https://matplotlib.org/stable/tutorials/colors/colormaps.html
/// - https://github.com/matplotlib/matplotlib/blob/710fce3df95e22701bd68bf6af2c8adbc9d67a79/lib/matplotlib/_cm_listed.py#L517
pub const PLASMA: [Rgb; 256] = [
    Rgb([13, 8, 135]),
    Rgb([16, 7, 136]),
    Rgb([19, 7, 137]),
    Rgb([22, 7, 138]),
    Rgb([25, 6, 140]),
    Rgb([27, 6, 141]),
    Rgb([29, 6, 142]),
    Rgb([32, 6, 143]),
    Rgb([34, 6, 144]),
    Rgb([36, 6, 145]),
    Rgb([38, 5, 145]),
    Rgb([40, 5, 146]),
    Rgb([42, 5, 147]),
    Rgb([44, 5, 148]),
    Rgb([46, 5, 149]),
    Rgb([47, 5, 150]),
    Rgb([49, 5, 151]),
    Rgb([51, 5, 151]),
    Rgb([53, 4, 152]),
    Rgb([55, 4, 153]),
    Rgb([56, 4, 154]),
    Rgb([58, 4, 154]),
    Rgb([60, 4, 155]),
    Rgb([62, 4, 156]),
    Rgb([63, 4, 156]),
    Rgb([65, 4, 157]),
    Rgb([67, 3, 158]),
    Rgb([68, 3, 158]),
    Rgb([70, 3, 159]),
    Rgb([72, 3, 159]),
    Rgb([73, 3, 160]),
    Rgb([75, 3, 161]),
    Rgb([76, 2, 161]),
    Rgb([78, 2, 162]),
    Rgb([80, 2, 162]),
    Rgb([81, 2, 163]),
    Rgb([83, 2, 163]),
    Rgb([85, 2, 164]),
    Rgb([86, 1, 164]),
    Rgb([88, 1, 164]),
    Rgb([89, 1, 165]),
    Rgb([91, 1, 165]),
    Rgb([92, 1, 166]),
    Rgb([94, 1, 166]),
    Rgb([96, 1, 166]),
    Rgb([97, 0, 167]),
    Rgb([99, 0, 167]),
    Rgb([100, 0, 167]),
    Rgb([102, 0, 167]),
    Rgb([103, 0, 168]),
    Rgb([105, 0, 168]),
    Rgb([106, 0, 168]),
    Rgb([108, 0, 168]),
    Rgb([110, 0, 168]),
    Rgb([111, 0, 168]),
    Rgb([113, 0, 168]),
    Rgb([114, 1, 168]),
    Rgb([116, 1, 168]),
    Rgb([117, 1, 168]),
    Rgb([119, 1, 168]),
    Rgb([120, 1, 168]),
    Rgb([122, 2, 168]),
    Rgb([123, 2, 168]),
    Rgb([125, 3, 168]),
    Rgb([126, 3, 168]),
    Rgb([128, 4, 168]),
    Rgb([129, 4, 167]),
    Rgb([131, 5, 167]),
    Rgb([132, 5, 167]),
    Rgb([134, 6, 166]),
    Rgb([135, 7, 166]),
    Rgb([136, 8, 166]),
    Rgb([138, 9, 165]),
    Rgb([139, 10, 165]),
    Rgb([141, 11, 165]),
    Rgb([142, 12, 164]),
    Rgb([143, 13, 164]),
    Rgb([145, 14, 163]),
    Rgb([146, 15, 163]),
    Rgb([148, 16, 162]),
    Rgb([149, 17, 161]),
    Rgb([150, 19, 161]),
    Rgb([152, 20, 160]),
    Rgb([153, 21, 159]),
    Rgb([154, 22, 159]),
    Rgb([156, 23, 158]),
    Rgb([157, 24, 157]),
    Rgb([158, 25, 157]),
    Rgb([160, 26, 156]),
    Rgb([161, 27, 155]),
    Rgb([162, 29, 154]),
    Rgb([163, 30, 154]),
    Rgb([165, 31, 153]),
    Rgb([166, 32, 152]),
    Rgb([167, 33, 151]),
    Rgb([168, 34, 150]),
    Rgb([170, 35, 149]),
    Rgb([171, 36, 148]),
    Rgb([172, 38, 148]),
    Rgb([173, 39, 147]),
    Rgb([174, 40, 146]),
    Rgb([176, 41, 145]),
    Rgb([177, 42, 144]),
    Rgb([178, 43, 143]),
    Rgb([179, 44, 142]),
    Rgb([180, 46, 141]),
    Rgb([181, 47, 140]),
    Rgb([182, 48, 139]),
    Rgb([183, 49, 138]),
    Rgb([184, 50, 137]),
    Rgb([186, 51, 136]),
    Rgb([187, 52, 136]),
    Rgb([188, 53, 135]),
    Rgb([189, 55, 134]),
    Rgb([190, 56, 133]),
    Rgb([191, 57, 132]),
    Rgb([192, 58, 131]),
    Rgb([193, 59, 130]),
    Rgb([194, 60, 129]),
    Rgb([195, 61, 128]),
    Rgb([196, 62, 127]),
    Rgb([197, 64, 126]),
    Rgb([198, 65, 125]),
    Rgb([199, 66, 124]),
    Rgb([200, 67, 123]),
    Rgb([201, 68, 122]),
    Rgb([202, 69, 122]),
    Rgb([203, 70, 121]),
    Rgb([204, 71, 120]),
    Rgb([204, 73, 119]),
    Rgb([205, 74, 118]),
    Rgb([206, 75, 117]),
    Rgb([207, 76, 116]),
    Rgb([208, 77, 115]),
    Rgb([209, 78, 114]),
    Rgb([210, 79, 113]),
    Rgb([211, 81, 113]),
    Rgb([212, 82, 112]),
    Rgb([213, 83, 111]),
    Rgb([213, 84, 110]),
    Rgb([214, 85, 109]),
    Rgb([215, 86, 108]),
    Rgb([216, 87, 107]),
    Rgb([217, 88, 106]),
    Rgb([218, 90, 106]),
    Rgb([218, 91, 105]),
    Rgb([219, 92, 104]),
    Rgb([220, 93, 103]),
    Rgb([221, 94, 102]),
    Rgb([222, 95, 101]),
    Rgb([222, 97, 100]),
    Rgb([223, 98, 99]),
    Rgb([224, 99, 99]),
    Rgb([225, 100, 98]),
    Rgb([226, 101, 97]),
    Rgb([226, 102, 96]),
    Rgb([227, 104, 95]),
    Rgb([228, 105, 94]),
    Rgb([229, 106, 93]),
    Rgb([229, 107, 93]),
    Rgb([230, 108, 92]),
    Rgb([231, 110, 91]),
    Rgb([231, 111, 90]),
    Rgb([232, 112, 89]),
    Rgb([233, 113, 88]),
    Rgb([233, 114, 87]),
    Rgb([234, 116, 87]),
    Rgb([235, 117, 86]),
    Rgb([235, 118, 85]),
    Rgb([236, 119, 84]),
    Rgb([237, 121, 83]),
    Rgb([237, 122, 82]),
    Rgb([238, 123, 81]),
    Rgb([239, 124, 81]),
    Rgb([239, 126, 80]),
    Rgb([240, 127, 79]),
    Rgb([240, 128, 78]),
    Rgb([241, 129, 77]),
    Rgb([241, 131, 76]),
    Rgb([242, 132, 75]),
    Rgb([243, 133, 75]),
    Rgb([243, 135, 74]),
    Rgb([244, 136, 73]),
    Rgb([244, 137, 72]),
    Rgb([245, 139, 71]),
    Rgb([245, 140, 70]),
    Rgb([246, 141, 69]),
    Rgb([246, 143, 68]),
    Rgb([247, 144, 68]),
    Rgb([247, 145, 67]),
    Rgb([247, 147, 66]),
    Rgb([248, 148, 65]),
    Rgb([248, 149, 64]),
    Rgb([249, 151, 63]),
    Rgb([249, 152, 62]),
    Rgb([249, 154, 62]),
    Rgb([250, 155, 61]),
    Rgb([250, 156, 60]),
    Rgb([250, 158, 59]),
    Rgb([251, 159, 58]),
    Rgb([251, 161, 57]),
    Rgb([251, 162, 56]),
    Rgb([252, 163, 56]),
    Rgb([252, 165, 55]),
    Rgb([252, 166, 54]),
    Rgb([252, 168, 53]),
    Rgb([252, 169, 52]),
    Rgb([253, 171, 51]),
    Rgb([253, 172, 51]),
    Rgb([253, 174, 50]),
    Rgb([253, 175, 49]),
    Rgb([253, 177, 48]),
    Rgb([253, 178, 47]),
    Rgb([253, 180, 47]),
    Rgb([253, 181, 46]),
    Rgb([254, 183, 45]),
    Rgb([254, 184, 44]),
    Rgb([254, 186, 44]),
    Rgb([254, 187, 43]),
    Rgb([254, 189, 42]),
    Rgb([254, 190, 42]),
    Rgb([254, 192, 41]),
    Rgb([253, 194, 41]),
    Rgb([253, 195, 40]),
    Rgb([253, 197, 39]),
    Rgb([253, 198, 39]),
    Rgb([253, 200, 39]),
    Rgb([253, 202, 38]),
    Rgb([253, 203, 38]),
    Rgb([252, 205, 37]),
    Rgb([252, 206, 37]),
    Rgb([252, 208, 37]),
    Rgb([252, 210, 37]),
    Rgb([251, 211, 36]),
    Rgb([251, 213, 36]),
    Rgb([251, 215, 36]),
    Rgb([250, 216, 36]),
    Rgb([250, 218, 36]),
    Rgb([249, 220, 36]),
    Rgb([249, 221, 37]),
    Rgb([248, 223, 37]),
    Rgb([248, 225, 37]),
    Rgb([247, 226, 37]),
    Rgb([247, 228, 37]),
    Rgb([246, 230, 38]),
    Rgb([246, 232, 38]),
    Rgb([245, 233, 38]),
    Rgb([245, 235, 39]),
    Rgb([244, 237, 39]),
    Rgb([243, 238, 39]),
    Rgb([243, 240, 39]),
    Rgb([242, 242, 39]),
    Rgb([241, 244, 38]),
    Rgb([241, 245, 37]),
    Rgb([240, 247, 36]),
    Rgb([240, 249, 33]),
];
